{% extends "layout_with_navbar.html" %}
{%block content %}

<div style="margin-left:auto; margin-right:auto;">
    <h2 style = text-align:center;color:black>Perishables</h2>
    <h2>
        <div class="btn-group btn-group-toggle" data-toggle="buttons"> 
            <label class="btn btn-info active">
            <input style = "visibility:hidden" type="radio" name="status" value="all" checked="checked"> All
            </label>
            <label class="btn btn-success">
                <input style = "visibility:hidden" type="radio" name="status" value="active"> Active
            </label>
            <label class="btn btn-danger">
                <input style = "visibility:hidden" type="radio" name="status" value="picked-up"> Picked Up
            </label>
        </div>
    </h2>
</div>

<table id="packagesTable" class="table table-striped table-hover">
    <thead>
        <tr>
            <th>Package&nbsp;Number</th>
            <th>Name</th>
            <th>Room&nbsp;Number</th>
            <th>Description</th>
            <th>Status</th>
            <th>Delivery Date</th>
            <th>DR</th>
        </tr>
    </thead>
    <tbody class="table-danger">
        {% for package in packages.items %}
        <tr data-status="active">
            <td>{{ package.id }}</td>
            <td>{{ package.fname }} {{ package.lname }}</td>
            <td>{{ package.roomNum }}</td>
            <td>{{ package.description }}</td>
            {% if package.status == "Active" %}
            <td><span class="badge badge-success">{{ package.status }}</span></td>
            {% elif package.status == "Picked Up" %}
            <td><span class="badge badge-danger">{{ package.status }}</span></td>
            {% endif %}
            <td>{{ package.delivery_date.strftime('%m-%d-%Y') }}</td>
            <td>{{ package.dr }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

{% for page_num in packages.iter_pages(left_edge=1, right_edge=1, left_current=3, right_current=3) %}
{% if page_num %}
{% if packages.page == page_num %}
<a class="btn btn-secondary mb-4" href="{{ url_for('packages.package', page=page_num) }}">{{ page_num }}</a>
{% else %}
<a class="btn btn-light mb-4" href="{{ url_for('packages.package', page=page_num) }}">{{ page_num }}</a>
{% endif %}
{% else %}
....
{% endif %}
{% endfor %}
</div>

<script type="text/javascript">
    $(document).ready(function () {
        $(".btn-group .btn").click(function () {
            var inputValue = $(this).find("input").val();
            if (inputValue != 'all') {
                var target = $('table tr[data-status="' + inputValue + '"]');
                $("table tbody tr").not(target).hide();
                target.fadeIn();
            } else {
                $("table tbody tr").fadeIn();
            }
        });
        // Changing the class of status label to support Bootstrap 4
        var bs = $.fn.tooltip.Constructor.VERSION;
        var str = bs.split(".");
        if (str[0] == 4) {
            $(".label").each(function () {
                var classStr = $(this).attr("class");
                var newClassStr = classStr.replace(/label/g, "badge");
                $(this).removeAttr("class").addClass(newClassStr);
            });
        }
    });
</script>

{% endblock %}